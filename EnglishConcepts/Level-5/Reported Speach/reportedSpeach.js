let directToReportedSpeechQuiz = [
  {
    question: `Convert to reported speech: "We will go to the beach tomorrow," they said.`,
    options: {
      A: `They said that they would go to the beach the next day.`,
      B: `They said that they will go to the beach the next day.`,
      C: `They said that they went to the beach tomorrow.`,
      D: `They said that they would have gone to the beach the next day.`,
    },
    correctAnswer: `A`,
    explanation: `Future simple ("will go") changes to conditional ("would go") in reported speech, and "tomorrow" becomes "the next day."`,
  },
  {
    question: `Convert to reported speech: "I have finished my homework," she said.`,
    options: {
      A: `She said that she has finished her homework.`,
      B: `She said that she had finished her homework.`,
      C: `She said that she finishes her homework.`,
      D: `She said that she will have finished her homework.`,
    },
    correctAnswer: `B`,
    explanation: `Present perfect ("have finished") changes to past perfect ("had finished") in reported speech.`,
  },
  {
    question: `Convert to reported speech: "You should call me when you arrive," he said.`,
    options: {
      A: `He said that I should call him when I arrived.`,
      B: `He said that I should call him when I arrive.`,
      C: `He said that I should have called him when I arrived.`,
      D: `He said that I should call him when I have arrived.`,
    },
    correctAnswer: `A`,
    explanation: `"Should" remains the same in reported speech. The pronoun and tense of "arrive" change to match the reporting context.`,
  },
  {
    question: `Convert to reported speech: "I will be going to the party," she said.`,
    options: {
      A: `She said that she will be going to the party.`,
      B: `She said that she would be going to the party.`,
      C: `She said that she was going to the party.`,
      D: `She said that she had been going to the party.`,
    },
    correctAnswer: `B`,
    explanation: `Future continuous ("will be going") changes to conditional continuous ("would be going") in reported speech.`,
  },
  {
    question: `Convert to reported speech: "I can swim very well," he said.`,
    options: {
      A: `He said that he can swim very well.`,
      B: `He said that he could swim very well.`,
      C: `He said that he could swim very well.`,
      D: `He said that he could have swum very well.`,
    },
    correctAnswer: `B`,
    explanation: `"Can" changes to "could" in reported speech when the reporting verb is in the past.`,
  },
  {
    question: `Convert to reported speech: "I am tired," she said.`,
    options: {
      A: `She said that she was tired.`,
      B: `She said that she is tired.`,
      C: `She said that she will be tired.`,
      D: `She said that she had been tired.`,
    },
    correctAnswer: `A`,
    explanation: `Present simple ("am") changes to past simple ("was") in reported speech.`,
  },
  {
    question: `Convert to reported speech: "I saw the movie yesterday," he said.`,
    options: {
      A: `He said that he saw the movie the day before.`,
      B: `He said that he had seen the movie yesterday.`,
      C: `He said that he sees the movie yesterday.`,
      D: `He said that he would see the movie the day before.`,
    },
    correctAnswer: `A`,
    explanation: `Past simple ("saw") remains in past simple ("saw") but "yesterday" changes to "the day before."`,
  },
  {
    question: `Convert to reported speech: "I am going to buy a new car," he said.`,
    options: {
      A: `He said that he was going to buy a new car.`,
      B: `He said that he is going to buy a new car.`,
      C: `He said that he would buy a new car.`,
      D: `He said that he has been going to buy a new car.`,
    },
    correctAnswer: `A`,
    explanation: `"Am going to" changes to "was going to" in reported speech.`,
  },
  {
    question: `Convert to reported speech: "I have been waiting for hours," she said.`,
    options: {
      A: `She said that she had been waiting for hours.`,
      B: `She said that she has been waiting for hours.`,
      C: `She said that she was waiting for hours.`,
      D: `She said that she had waited for hours.`,
    },
    correctAnswer: `A`,
    explanation: `Present perfect continuous ("have been waiting") changes to past perfect continuous ("had been waiting") in reported speech.`,
  },
  {
    question: `Convert to reported speech: "I don't understand the question," she said.`,
    options: {
      A: `She said that she didn't understand the question.`,
      B: `She said that she doesn't understand the question.`,
      C: `She said that she hadn't understood the question.`,
      D: `She said that she won't understand the question.`,
    },
    correctAnswer: `A`,
    explanation: `Present simple negative ("don't understand") changes to past simple negative ("didn't understand") in reported speech.`,
  },
  {
    question: `Convert to reported speech: "I was reading when she called," he said.`,
    options: {
      A: `He said that he had been reading when she called.`,
      B: `He said that he was reading when she called.`,
      C: `He said that he has been reading when she called.`,
      D: `He said that he was read when she called.`,
    },
    correctAnswer: `A`,
    explanation: `Past continuous ("was reading") changes to past perfect continuous ("had been reading") in reported speech.`,
  },
  {
    question: `Convert to reported speech: "I have finished my book," she said.`,
    options: {
      A: `She said that she had finished her book.`,
      B: `She said that she has finished her book.`,
      C: `She said that she finished her book.`,
      D: `She said that she will finish her book.`,
    },
    correctAnswer: `A`,
    explanation: `Present perfect ("have finished") changes to past perfect ("had finished") in reported speech.`,
  },
  {
    question: `Convert to reported speech: "Will you help me with this task?" he asked.`,
    options: {
      A: `He asked if I would help him with this task.`,
      B: `He asked if I will help him with this task.`,
      C: `He asked if I helped him with this task.`,
      D: `He asked if I would have helped him with this task.`,
    },
    correctAnswer: `A`,
    explanation: `Future simple ("will help") changes to conditional ("would help") in reported speech.`,
  },
  {
    question: `Convert to reported speech: "I will call you when I arrive," she said.`,
    options: {
      A: `She said that she would call me when she arrived.`,
      B: `She said that she will call me when she arrives.`,
      C: `She said that she would call me when she arrives.`,
      D: `She said that she called me when she arrived.`,
    },
    correctAnswer: `A`,
    explanation: `Future simple ("will call") changes to conditional ("would call"), and "arrive" changes to "arrived" in reported speech.`,
  },
  {
    question: `Convert to reported speech: "I was planning to leave earlier," he said.`,
    options: {
      A: `He said that he had been planning to leave earlier.`,
      B: `He said that he was planning to leave earlier.`,
      C: `He said that he had planned to leave earlier.`,
      D: `He said that he is planning to leave earlier.`,
    },
    correctAnswer: `A`,
    explanation: `Past continuous ("was planning") changes to past perfect continuous ("had been planning") in reported speech.`,
  },
];

let quiz_container = document.getElementById("quizContainer");
let result_div = document.getElementById("result");
let result_container = document.getElementById("resultText"); // Correctly targets the #resultText element
let submit_quiz = document.getElementById("submit");
let reset_quiz = document.getElementById("reset");

// Shuffle function for randomizing questions
function shuffle(array) {
  for (let i = array.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [array[i], array[j]] = [array[j], array[i]];
  }
  return array;
}

shuffle(directToReportedSpeechQuiz);

// Display questions dynamically
function display_questions() {
  directToReportedSpeechQuiz.forEach((element, index) => {
    let questionNumber = index + 1;
    let question_div = document.createElement("div");
    question_div.id = "questionsDiv";

    question_div.innerHTML = `<h2 id="questionNumberAndQuestion">${questionNumber}. ${element.question}</h2>`;

    quiz_container.appendChild(question_div);
    let options_div = document.createElement("div");
    options_div.id = "optionsDiv";

    for (const [key, value] of Object.entries(element.options)) {
      let options_inner_div = document.createElement("div");
      options_inner_div.id = "optionsInnerDiv";
      let radio_button = document.createElement("input");
      radio_button.type = "radio";
      radio_button.name = `question${index}`;
      radio_button.id = `radioButton-${index}-${key}`;
      radio_button.value = value;
      let label = document.createElement("label");
      label.textContent = `${key}: ${value}`;

      options_inner_div.appendChild(radio_button);
      question_div.appendChild(options_div);
      options_inner_div.appendChild(label);
      options_div.appendChild(options_inner_div);
    }
    let explanation = document.createElement("div");
    explanation.classList = "explanation";

    explanation.style.display = "none";
    question_div.appendChild(explanation);
  });
}
display_questions();

// Submit quiz and calculate score
submit_quiz.addEventListener("click", function () {
  let score = 0;
  let questions = directToReportedSpeechQuiz.length;
  result_container.innerHTML = ""; // Clear previous results

  directToReportedSpeechQuiz.forEach((element, index) => {
    let radio_button = document.querySelector(
      `input[name="question${index}"]:checked`
    );

    let explanation = document.querySelectorAll(".explanation")[index];
    explanation.style.display = "block";

    if (radio_button) {
      if (radio_button.value === element.correctAnswer) {
        score++;
        explanation.style.color = "green";
        explanation.innerHTML = `<p>Correct! - "${element.correctAnswer}" is the right answer</p><p>Explanation: ${element.explanation}</p>`;
      } else {
        explanation.style.color = "red";
        explanation.innerHTML = `<p>Incorrect! - "${element.correctAnswer}" is the right answer</p><p>Explanation: ${element.explanation}<p/>`;
      }
    } else {
      explanation.innerHTML = `<p>No Answer Selected</p><p>The correct answer is: ${element.correctAnswer}<p/><p>Explanation: ${element.explanation}</p>`;
    }
  });

  result_container.textContent = `Your score is: ${score} out of ${questions}`;
  result_div.style.display = "block"; // Ensure result div is displayed
});

// Reset quiz functionality
reset_quiz.addEventListener("click", function () {
  // Clear all radio button selections
  document.querySelectorAll("input[type=radio]").forEach((element) => {
    element.checked = false;
  });

  // Hide all explanations and clear their content
  document.querySelectorAll(".explanation").forEach((element) => {
    element.style.display = "none";
    element.innerHTML = "";
  });

  // Hide the result container and clear its content
  result_div.style.display = "none";
  result_container.innerHTML = ""; // Clear the result text content
});
